<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>3D Anaglyph Solar System</title>
            <style>
                body { margin: 0; overflow: hidden; background: black; }
                #brightnessToggle {
                position: absolute;
                top: 10px; left: 10px;
                z-index: 10;
                background: rgba(255,255,255,0.2);
                color: white;
                border: 1px solid white;
                padding: 8px 12px;
                border-radius: 8px;
                cursor: pointer;
                font-family: sans-serif;
                }
            </style>
    </head>

	<body>
         <button id="brightnessToggle">Toggle Stars Brightness</button>
         <label style="position:absolute; top:10px; right:10px; color:white;">
                Ambient Light: <input type="range" id="ambientSlider" min="0" max="2" step="0.01" value="0.33">
        </label>

		<script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js",
					"three/addons/": "./jsm/"
				}
			}
		</script>

		<script type="module">

			import * as THREE from 'three';

			import Stats from 'three/addons/libs/stats.module.js';

			import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
			import { AnaglyphEffect } from 'three/addons/effects/AnaglyphEffect.js';
            // Scene setup
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(innerWidth, innerHeight);
                document.body.appendChild(renderer.domElement);

                // Lighting (Sunlight)
                const pointLight = new THREE.PointLight(0xffffff, 2, 2000);
                scene.add(pointLight);

                // ---- TEXTURE SOURCES ----
                const textures = {
                sun: 'textures/all-planets/sun.jpg',
                mercury: 'textures/all-planets/mercury.jpg',
                venus: 'textures/all-planets/venus.jpg',
                earth: 'textures/all-planets/earth.jpg',
                mars: 'textures/all-planets/mars.jpg',
                jupiter: 'textures/all-planets/jupiter.jpg',
                saturn: 'textures/all-planets/saturn.jpg',
                saturnRing: 'textures/all-planets/saturn_ring_alpha.png',
                uranus: 'textures/all-planets/uranus.jpg',
                neptune: 'textures/all-planets/neptune.jpg',
                // glow: 'textures/all-planets/glow.jpg'
                };

                // ---- SUN ----
                const sunTexture = new THREE.TextureLoader().load(textures.sun);
                const sunMaterial = new THREE.MeshBasicMaterial({ map: sunTexture });
                const sun = new THREE.Mesh(new THREE.SphereGeometry(5, 64, 64), sunMaterial);
                scene.add(sun);

                // Sun glow
                const glowTexture = new THREE.TextureLoader().load(textures.glow);
                const glowMaterial = new THREE.SpriteMaterial({
                map: glowTexture,
                color: 0xffaa33,
                transparent: true,
                blending: THREE.AdditiveBlending
                });
                const glow = new THREE.Sprite(glowMaterial);
                glow.scale.set(15, 15, 1.0);
                sun.add(glow);

                // ---- PLANETS ----
                const planets = [
                { name: 'Mercury', size: 0.5, dist: 8, texture: textures.mercury, speed: 0.04 },
                { name: 'Venus', size: 0.9, dist: 11, texture: textures.venus, speed: 0.015 },
                { name: 'Earth', size: 1, dist: 15, texture: textures.earth, speed: 0.01 },
                { name: 'Mars', size: 0.8, dist: 19, texture: textures.mars, speed: 0.008 },
                { name: 'Jupiter', size: 2, dist: 25, texture: textures.jupiter, speed: 0.005 },
                { name: 'Saturn', size: 1.8, dist: 32, texture: textures.saturn, speed: 0.004 },
                { name: 'Uranus', size: 1.4, dist: 38, texture: textures.uranus, speed: 0.003 },
                { name: 'Neptune', size: 1.3, dist: 44, texture: textures.neptune, speed: 0.002 }
                ];

                const planetMeshes = [];

                planets.forEach(p => {
                const tex = new THREE.TextureLoader().load(p.texture);
                const mat = new THREE.MeshStandardMaterial({ map: tex });
                const sphere = new THREE.Mesh(new THREE.SphereGeometry(p.size, 32, 32), mat);
                sphere.position.x = p.dist;
                scene.add(sphere);
                planetMeshes.push({ mesh: sphere, dist: p.dist, speed: p.speed, angle: Math.random() * Math.PI * 2 });

                // Orbit circle
                const curve = new THREE.EllipseCurve(0, 0, p.dist, p.dist);
                const points = curve.getPoints(100);
                const geometry = new THREE.BufferGeometry().setFromPoints(points);
                const orbit = new THREE.LineLoop(geometry, new THREE.LineBasicMaterial({ color: 0x444444 }));
                orbit.rotation.x = Math.PI / 2;
                scene.add(orbit);
// const ambientLight = new THREE.AmbientLight(0x888888);
// scene.add(ambientLight);
// Create ambient light
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.33); // initial intensity
            scene.add(ambientLight);
// sample code for satellite
// function createSatellite(size = 0.2, color = 0xffffff) {
//     const geometry = new THREE.SphereGeometry(size, 16, 16);
//     const material = new THREE.MeshStandardMaterial({ color });
//     const satellite = new THREE.Mesh(geometry, material);
//     return satellite;
// }
// // Assuming 'earthMesh' is your Earth planet mesh
// const earthPivot = new THREE.Object3D();
// scene.add(earthPivot);

// // Place satellite at some distance from Earth
// const satellite = createSatellite(0.2, 0xffaa00);
// satellite.position.set(2, 0, 0); // 2 units away from Earth
// earthPivot.add(satellite);

// // Optional: small trail/orbit line
// const orbitCurve = new THREE.EllipseCurve(
//     0, 0, 2, 2, 0, 2 * Math.PI
// );
// //const points = orbitCurve.getPoints(50);
// const orbitGeometry = new THREE.BufferGeometry().setFromPoints(points);
// const orbitLine = new THREE.LineLoop(orbitGeometry, new THREE.LineBasicMaterial({ color: 0x888888 }));
// orbitLine.rotation.x = Math.PI / 2;
// earthPivot.add(orbitLine);

// end sample code for satellite
            // Slider event listener
            const ambientSlider = document.getElementById('ambientSlider');
            ambientSlider.addEventListener('input', (event) => {
                ambientLight.intensity = parseFloat(event.target.value);
            });

                // Saturn's ring
                if (p.name === 'Saturn') {
                    const ringTex = new THREE.TextureLoader().load(textures.saturnRing);
                    const ringGeo = new THREE.RingGeometry(p.size * 1.4, p.size * 2.5, 64);
                    const ringMat = new THREE.MeshBasicMaterial({
                    map: ringTex,
                    side: THREE.DoubleSide,
                    transparent: true
                    });
                    const ring = new THREE.Mesh(ringGeo, ringMat);
                    ring.rotation.x = Math.PI / 2;
                    sphere.add(ring);
                }
                });

                // ---- STARS ----
                const starGeo = new THREE.BufferGeometry();
                const starVertices = [];
                for (let i = 0; i < 2000; i++) {
                const x = (Math.random() - 0.5) * 2000;
                const y = (Math.random() - 0.5) * 2000;
                const z = (Math.random() - 0.5) * 2000;
                starVertices.push(x, y, z);
                }
                starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
                const starMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.8 });
                const stars = new THREE.Points(starGeo, starMat);
                scene.add(stars);

                // ---- CAMERA + CONTROLS ----
                const controls = new OrbitControls(camera, renderer.domElement);
                camera.position.set(0, 20, 60);
                controls.update();

                // ---- STAR BRIGHTNESS TOGGLE ----
                let bright = true;
                document.getElementById('brightnessToggle').onclick = () => {
                bright = !bright;
                starMat.color.set(bright ? 0xffffff : 0x444444);
                starMat.size = bright ? 0.8 : 0.4;
                };

                // ---- ANIMATION LOOP ----
                function animate() {
                requestAnimationFrame(animate);
                        // // In your animation loop
                        // earthPivot.rotation.y += 0.05; // rotates satellite around Earth

                sun.rotation.y += 0.001;
                planetMeshes.forEach(p => {
                    p.angle += p.speed;
                    p.mesh.position.x = Math.cos(p.angle) * p.dist;
                    p.mesh.position.z = Math.sin(p.angle) * p.dist;
                    p.mesh.rotation.y += 0.01;
                });

                stars.rotation.y += 0.0001;
                controls.update();
                renderer.render(scene, camera);
                }
                animate();

                window.addEventListener('resize', () => {
                camera.aspect = innerWidth / innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(innerWidth, innerHeight);
                }); 
		</script>

	</body>
</html>

